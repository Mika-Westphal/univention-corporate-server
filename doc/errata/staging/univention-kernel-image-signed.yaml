product: ucs
release: "4.4"
version: [7]
scope: ucs_4.4-0-errata4.4-7
src: univention-kernel-image-signed
fix: 5.0.0-16A~4.4.0.202103182253
desc: |
 This update addresses the following issues:
 * use-after-free in rwsem_down_write_slowpath in kernel/locking/rwsem.c
   (CVE-2019-19318)
 * use-after-free in __mutex_lock in kernel/locking/mutex.c (CVE-2019-19813)
 * out-of-bounds write in __btrfs_map_block in fs/btrfs/volumes.c
   (CVE-2019-19816)
 * Array index out of bounds access when setting extended attributes on
   journaling filesystems. (CVE-2020-27815)
 * use-after-free in the ftrace ring buffer resizing logic due to a race
   condition (CVE-2020-27825)
 * SCSI target (LIO) write to any block on ILO backstore (CVE-2020-28374)
 * An issue was discovered in Xen through 4.14.x. Some OSes (such as Linux,
   FreeBSD, and NetBSD) are processing watch events using a single thread. If
   the events are received faster than the thread is able to handle, they will
   get queued. As the queue is unbounded, a guest may be able to trigger an
   OOM in the backend. All systems with a FreeBSD, Linux, or NetBSD (any
   version) dom0 are vulnerable. (CVE-2020-29568)
 * An issue was discovered in the Linux kernel through 5.10.1, as used with
   Xen through 4.14.x. The Linux kernel PV block backend expects the kernel
   thread handler to reset ring->xenblkd to NULL when stopped. However, the
   handler may not have time to run if the frontend quickly toggles between
   the states connect and disconnect. As a consequence, the block backend may
   re-use a pointer after it was freed. A misbehaving guest can trigger a dom0
   crash by continuously connecting / disconnecting a block frontend.
   Privilege escalation and information leaks cannot be ruled out. This only
   affects systems with a Linux blkback. (CVE-2020-29569)
 * locking inconsistency in drivers/tty/tty_io.c and drivers/tty/tty_jobctrl.c
   can lead to a read-after-free (CVE-2020-29660)
 * locking issue in drivers/tty/tty_jobctrl.c can lead to an use-after-free
   (CVE-2020-29661)
 * buffer overflow in mwifiex_cmd_802_11_ad_hoc_start function in
   drivers/net/wireless/marvell/mwifiex/join.c via a long SSID value
   (CVE-2020-36158)
 * path traversal in fs/nfsd/nfs3xdr.c may lead to Information Disclosure or
   RCE (CVE-2021-3178)
 * Use after free via PI futex state (CVE-2021-3347)
 * An issue was discovered in the Linux kernel 3.11 through 5.10.16, as used
   by Xen. To service requests to the PV backend, the driver maps grant
   references provided by the frontend. In this process, errors may be
   encountered. In one case, an error encountered earlier might be discarded
   by later processing, resulting in the caller assuming successful mapping,
   and hence subsequent operations trying to access space that wasn't mapped.
   In another case, internal state would be insufficiently updated, preventing
   safe recovery from the error. This affects
   drivers/block/xen-blkback/blkback.c. (CVE-2021-26930)
 * An issue was discovered in the Linux kernel 2.6.39 through 5.10.16, as used
   in Xen. Block, net, and SCSI backends consider certain errors a plain bug,
   deliberately causing a kernel crash. For errors potentially being at least
   under the influence of guests (such as out of memory conditions), it isn't
   correct to assume a plain bug. Memory allocations potentially causing such
   crashes occur only when Linux is running in PV mode, though. This affects
   drivers/block/xen-blkback/blkback.c and drivers/xen/xen-scsiback.c.
   (CVE-2021-26931)
 * An issue was discovered in the Linux kernel 3.2 through 5.10.16, as used by
   Xen. Grant mapping operations often occur in batch hypercalls, where a
   number of operations are done in a single hypercall, the success or failure
   of each one is reported to the backend driver, and the backend driver then
   loops over the results, performing follow-up actions based on the success
   or failure of each operation. Unfortunately, when running in PV mode, the
   Linux backend drivers mishandle this: Some errors are ignored, effectively
   implying their success from the success of related batch elements. In other
   cases, errors resulting from one batch element lead to further batch
   elements not being inspected, and hence successful ones to not be possible
   to properly unmap upon error recovery. Only systems with Linux backends
   running in PV mode are vulnerable. Linux backends run in HVM / PVH modes
   are not vulnerable. This affects arch/*/xen/p2m.c and drivers/xen/gntdev.c.
   (CVE-2021-26932)
 * iscsi: unrestricted access to sessions and handles (CVE-2021-27363)
 * out-of-bounds read in libiscsi module (CVE-2021-27364)
 * heap buffer overflow in the iSCSI subsystem (CVE-2021-27365)
 * An issue was discovered in the Linux kernel through 5.11.3, as used with
   Xen PV. A certain part of the netback driver lacks necessary treatment of
   errors such as failed memory allocations (as a result of changes to the
   handling of grant mapping errors). A host OS denial of service may occur
   during misbehavior of a networking frontend driver. NOTE: this issue exists
   because of an incomplete fix for CVE-2021-26931. (CVE-2021-28038)
note: This is the 3rd of three related updates.
bug: [52905]
cve:
- CVE-2019-19318
- CVE-2019-19813
- CVE-2019-19816
- CVE-2020-27815
- CVE-2020-27825
- CVE-2020-28374
- CVE-2020-29568
- CVE-2020-29569
- CVE-2020-29660
- CVE-2020-29661
- CVE-2020-36158
- CVE-2021-3178
- CVE-2021-3347
- CVE-2021-26930
- CVE-2021-26931
- CVE-2021-26932
- CVE-2021-27363
- CVE-2021-27364
- CVE-2021-27365
- CVE-2021-28038
